<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Markdown Editor</title>
    <!-- Include the Quill library -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <style>
        body { font-family: sans-serif; }
        #editor-container { min-height: 60vh; border: 1px solid #ccc; }
        .container {
            max-width: 900px;
            margin: 2rem auto;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>Quill Editor (Paste Markdown directly)</h2>

    <!-- Create the toolbar container -->
    <div id="toolbar-container">
        <span class="ql-formats">
            <select class="ql-header">
                <option value="1">Heading 1</option>
                <option value="2">Heading 2</option>
                <option value="3">Heading 3</option>
                <option selected>Normal</option>
            </select>
        </span>
        <span class="ql-formats">
            <button class="ql-bold"></button>
            <button class="ql-italic"></button>
            <button class="ql-underline"></button>
            <button class="ql-strike"></button>
        </span>
        <span class="ql-formats">
            <button class="ql-list" value="ordered"></button>
            <button class="ql-list" value="bullet"></button>
            <button class="ql-blockquote"></button>
            <button class="ql-code-block"></button>
        </span>
        <span class="ql-formats">
            <button class="ql-link"></button>
            <button class="ql-image"></button>
        </span>
        <span class="ql-formats">
            <button class="ql-clean"></button>
        </span>
    </div>

    <!-- Create the editor container -->
    <div id="editor-container"></div>

    <div style="margin-top: 2rem;">
        <button onclick="getHtml()">Get HTML Output</button>
        <h3>HTML Output:</h3>
        <pre><code id="html-output"></code></pre>
    </div>

</div>

    <!-- Include the Quill library -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <!-- Include the marked library -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Initialize Quill editor and add logic -->
    <script>
        var quill = new Quill('#editor-container', {
            modules: {
                toolbar: '#toolbar-container'
            },
            theme: 'snow'
        });

        // Listen for paste events to convert markdown
        quill.clipboard.addMatcher(Node.TEXT_NODE, (node, delta) => {
            // Get the pasted text
            const pastedText = node.data;

            // A simple check to see if it looks like markdown
            // This can be improved, but for now it checks for common markdown characters
            const isMarkdown = /[`*#\[\]\(\)!_-]/.test(pastedText);

            if (isMarkdown) {
                const html = marked.parse(pastedText);
                // Create a new Delta from the HTML
                const delta = quill.clipboard.convert(html);
                return delta;
            } else {
                // Not markdown, so return the original delta
                return delta;
            }
        });


        function getHtml() {
            const html = quill.root.innerHTML;
            document.getElementById('html-output').textContent = html;
        }
    </script>

</body>
</html>
